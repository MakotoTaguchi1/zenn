---
title: "Github Actionsã§è¤‡æ•°ç’°å¢ƒã®terraform planã‚’è‡ªå‹•åŒ–ã™ã‚‹"
emoji: "ğŸš€"
type: "tech"
topics:
  - "github"
  - "terraform"
  - "actions"
published: true
published_at: "2024-07-07 19:29"
---

# ã¯ã˜ã‚ã«
ç¾å ´ã§terraformã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®Gitlabã€€â†’ã€€GitHubç§»è¡Œã«ã‚ãŸã£ã¦ã€Github Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’çµ„ã‚€æ©Ÿä¼šãŒã‚ã‚Šã¾ã—ãŸã€‚
ãã“ã§ã€é‹ç”¨ã—ã‚„ã™ãã†ãªCIã‚’çµ„ã‚ãŸã®ã§ã€å…±æœ‰ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

# å‰æ/æ–¹é‡

- GoogleCloudï¼ˆä»¥ä¸‹GCPï¼‰ã‚¤ãƒ³ãƒ•ãƒ©ã‚’terraformç®¡ç†ã—ã¦ã„ã‚‹ã€‚
- ç’°å¢ƒã¯stgãƒ»prodã®2ã¤ã§ã€åˆ¥ã€…ã®GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ã€‚
- **ãƒ—ãƒ«ãƒªã‚¯ä½œæˆæ™‚ãƒ»æ›´æ–°æ™‚ã«terraform planã‚’å®Ÿè¡Œã—ãŸã„ã€‚**
- plançµæœã¯`tfcmt`ã¨ã„ã†ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã—ã€ãƒ—ãƒ«ãƒªã‚¯ä¸Šã«è‡ªå‹•ã§ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ã‚‚ã‚‰ã†ã€‚
- å„ç’°å¢ƒç”¨ã§åˆ¥ã€…ã®Github Secretsã‚’ç™»éŒ²ã—ã¦ã„ã‚‹ã€‚

ã¾ãŸã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã€‚
`src/common`ã¯stgãƒ»prodã®å…±é€šãƒªã‚½ãƒ¼ã‚¹ã§ã™ã€‚
```
src/
ã€€â”œ common/
ã€€â”‚ã€€ã€€â”œ moduleA/
ã€€â”‚ã€€ã€€â”œ moduleB/
ã€€â”‚ã€€ã€€â”” ...
ã€€â”œ stg/
ã€€â”‚ã€€ã€€â”œ main.tf
ã€€â”‚ã€€ã€€â”” ...
ã€€â”œ prod/
ã€€â”‚ã€€ã€€â”œ main.tf
  ã€€â”” ...
```

Actionsã®å®Ÿè¡Œæ™‚é–“ç¯€ç´„ã®ãŸã‚ã«ã‚‚ã€ä»¥ä¸‹ã‚’å®Ÿç¾ã—ãŸã‹ã£ãŸã§ã™ã€‚
- src/stgãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤‰æ›´ãŒã‚ã£ãŸã‚‰stgã«planå®Ÿè¡Œ
- src/prodãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤‰æ›´ãŒã‚ã£ãŸã‚‰prodã«planå®Ÿè¡Œ
- **src/commonã«å¤‰æ›´ãŒã‚ã£ãŸã‚‰stgãƒ»prodä¸¡æ–¹ã«planå®Ÿè¡Œ**


# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“

ã¯ã˜ã‚ã«ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚å¤§ããï¼’æ®µéšã®ã‚¸ãƒ§ãƒ–ã«åˆ†ã‹ã‚Œã¾ã™ã€‚
1. mainãƒ–ãƒ©ãƒ³ãƒã¨ã®å¤‰æ›´æ¤œå‡º
2. æ¤œå‡ºã—ãŸç’°å¢ƒã«terraform planï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰

.github/workflows/terraform-plan.yaml
```yaml
name: terraform-plan

on:
  pull_request:
    branches:
      - main
    paths:
      - "src/**"
    types:
      - opened
      - reopened
      - synchronize

jobs:
  # mainãƒ–ãƒ©ãƒ³ãƒã¨å·®åˆ†ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¤œå‡º
  # common ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ prod/stg å…±é€šãªã®ã§ã€ä¸¡æ–¹ã‚’å®Ÿè¡Œå¯¾è±¡ã«ã™ã‚‹
  check_changed_dirs:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    outputs:
      matrix: ${{ steps.set-matrix.outputs.matrix }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: set-matrix
        id: set-matrix
        run: |
          CHANGES=$(git diff --name-only origin/main | grep 'src/' | awk -F'/' '{print $2}' | uniq)
          INCLUDE_PROD=false
          INCLUDE_STG=false
          if echo "$CHANGES" | grep -q 'prod'; then
            INCLUDE_PROD=true
          fi
          if echo "$CHANGES" | grep -q 'stg'; then
            INCLUDE_STG=true
          fi
          if echo "$CHANGES" | grep -q 'common'; then
            INCLUDE_PROD=true
            INCLUDE_STG=true
          fi
          MATRIX="{\"include\": ["
          if [ "$INCLUDE_PROD" = true ]; then
            MATRIX+='{"dir":"src/prod", "credentials_key": "GCP_CREDENTIALS_PROD", "project_id_key": "GCP_PROJECT_ID_PROD"},'
          fi
          if [ "$INCLUDE_STG" = true ]; then
            MATRIX+='{"dir":"src/stg", "credentials_key": "GCP_CREDENTIALS_STG", "project_id_key": "GCP_PROJECT_ID_STG"},'
          fi
          MATRIX+="]}"
          echo "::set-output name=matrix::$MATRIX"

  tf-plan:
    runs-on: ubuntu-latest
    needs: check_changed_dirs
    timeout-minutes: 10
    strategy:
      fail-fast: false # ã‚ã‚‹ã‚¸ãƒ§ãƒ–ãŒå¤±æ•—ã—ã¦ã‚‚ä¸¦è¡Œã‚¸ãƒ§ãƒ–ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã›ãªã„
      matrix: ${{ fromJSON(needs.check_changed_dirs.outputs.matrix) }}
    defaults:
      run:
        shell: bash
        working-directory: ${{ matrix.dir }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Environment
        run: echo "Running Terraform scripts in ${{ matrix.dir }}"

      - name: auth
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets[matrix.credentials_key] }}

      - name: Set up Google Cloud SDK
        uses: google-github-actions/setup-gcloud@v2
        with:
          version: "477.0.0"
          project_id: ${{ secrets[matrix.project_id_key] }}

      - name: install tfcmt
        run: |
          sudo curl -fL -o tfcmt.tar.gz https://github.com/suzuki-shunsuke/tfcmt/releases/download/$TFCMT_VERSION/tfcmt_linux_amd64.tar.gz
          sudo tar -C /usr/bin -xzf ./tfcmt.tar.gz
        env:
          TFCMT_VERSION: v4.0.0

      - name: setup terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: 1.9.0

      - name: terraform fmt
        run: terraform fmt
        continue-on-error: true

      - name: terraform init
        run: terraform init

      - name: tfcmt plan
        run: tfcmt -var "target:$(echo ${{ matrix.dir }} | sed 's/src\///g')" plan -patch -- terraform plan -no-color -lock=false
        env:
          PR_HEAD_SHA: ${{ github.event.pull_request.head.sha }}
          PR_NUMBER: ${{ github.event.number }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

# ãã‚Œãã‚Œè©³ã—ã

## 1. check_changed_dirsï¼ˆå¤‰æ›´æ¤œçŸ¥ã‚¸ãƒ§ãƒ–ï¼‰

å¤‰æ›´å·®åˆ†ã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¤œå‡ºã—ã€å¾Œç¶šã®tf-planã«å€¤ã‚’æ¸¡ã—ã¾ã™ã€‚
ä¸»ã«ä»¥ä¸‹ã®ç‚¹ã‚’è€ƒæ…®ã—ã¾ã—ãŸã€‚

- `src`ä»¥ä¸‹ã§mainãƒ–ãƒ©ãƒ³ãƒã¨å·®åˆ†ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¤œå‡ºã—ã€å¾Œç¶šã®matrixæˆ¦ç•¥ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰ã®ãŸã‚ã«å€¤ã‚’æ¸¡ã™ã€‚
- common, prod, stgãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§åˆ†å²ãŒç™ºç”Ÿã™ã‚‹ã®ã§ã€æ¡ä»¶`INCLUDE_STG`, `INCLUDE_PROD`ãƒ•ãƒ©ã‚°ã«ã‚ˆã‚Šã€ã©ã®ç’°å¢ƒã«planã™ã‚‹ã‹æ±ºå®šã€‚
- å‚ç…§ã™ã‚‹Github SecretåãŒstgãƒ»prodã§ç•°ãªã‚‹ã®ã§ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼ï¼ˆå€¤ã§ã¯ãªã„ï¼‰ã¨ã—ã¦`credentials_key`, `project_id_key`ã§å‹•çš„ã«æ¸¡ã™ã€‚ï¼ˆè©³ç´°å¾Œè¿°ï¼‰

outputã«ã¤ã„ã¦å°‘ã—è©³ã—ãè§£èª¬ã™ã‚‹ã¨ã€
æ¡ä»¶ãƒ•ãƒ©ã‚°ãŒ`INCLUDE_PROD=true`, `INCLUDE_STG=true`ã ã£ãŸå ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ãªoutputã«ãªã‚Šã¾ã™ã€‚

```json
{
  "include": [
    {
      "dir": "src/prod",
      "credentials_key": "GCP_CREDENTIALS_PROD",
      "project_id_key": "GCP_PROJECT_ID_PROD"
    },
    {
      "dir": "src/stg",
      "credentials_key": "GCP_CREDENTIALS_STG",
      "project_id_key": "GCP_PROJECT_ID_STG"
    }
  ]
}
```

å¾Œç¶štf-planã‚¹ãƒ†ãƒƒãƒ—ã®`fromJSON`ã«ã‚ˆã‚Šã€ã“ã‚ŒãŒmatrixãƒ–ãƒ­ãƒƒã‚¯ã«å±•é–‹ã•ã‚Œã€ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚
```yaml
      matrix: 
        include:
          - dir: "src/prod"
            credentials_key: "GCP_CREDENTIALS_PROD"
            project_id_key: "GCP_PROJECT_ID_PROD"
          - dir: "src/stg"
            credentials_key: "GCP_CREDENTIALS_STG"
            project_id_key: "GCP_PROJECT_ID_STG"
```


ä»Šå›ãƒãƒˆãƒªãƒƒã‚¯ã‚¹å¤‰æ•°ã¯æŒ‡å®šã—ã¦ã„ãªã„ã®ã§ã€includeã‚¨ãƒ³ãƒˆãƒªã®åˆ†ã ã‘ã€ã¤ã¾ã‚Š2ã¤ã®ã‚¸ãƒ§ãƒ–ãŒä¸¦åˆ—å®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚
ã¡ãªã¿ã«includeã«ã¤ã„ã¦ã¯[ã“ã¡ã‚‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä¾‹](https://docs.github.com/ja/actions/using-jobs/using-a-matrix-for-your-jobs#example-adding-configurations)ãŒåˆ†ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚
matrixã¯è¤‡æ•°ã®å¤‰æ•°ã®çµ„ã¿åˆã‚ã›ã§ã‚¸ãƒ§ãƒ–ã‚’ä¸¦åˆ—å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ãªã®ã§ã€ãƒ¡ã‚¤ãƒ³ã®ä½¿ã„æ–¹ã§ã¯ãªã„æ°—ãŒã—ã¾ã™ãŒã€ä»Šå›ã¯includeã ã‘ã§è¦ä»¶ã‚’æº€ãŸã›ãŸã®ã§æ¡ç”¨ã—ã¾ã—ãŸã€‚


## 2. tf-planã‚¸ãƒ§ãƒ–

### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
```yaml
    defaults:
      run:
        shell: bash
        working-directory: ${{ matrix.dir }}
```

ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã§ã€ã‚¸ãƒ§ãƒ–ã«ç”¨ã„ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚·ã‚§ãƒ«ã‚„ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã—ã¾ã™ã€‚

terraform planã®å®Ÿè¡Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯`src/stg`, `src/prod`ã®ï¼’ãƒ‘ã‚¿ãƒ¼ãƒ³ãªã®ã§ã€å‰ã‚¹ãƒ†ãƒƒãƒ—ã‹ã‚‰å—ã‘å–ã£ãŸ`matrix.dir`ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

### matrixã®æŒ™å‹•
å¤‰æ›´æ¤œçŸ¥ã®èª¬æ˜ã§æ—¢ã«æ›¸ãã¾ã—ãŸãŒã€matrixæˆ¦ç•¥ã«ã‚ˆã‚Šincludeã‚¨ãƒ³ãƒˆãƒªã®æ•°ã ã‘ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ä»Šå›ã¯æœ€å¤§2ã¤ã®ã‚¸ãƒ§ãƒ–ï¼ˆstgãƒ»prodï¼‰ãŒä¸¦åˆ—ã§èµ°ã‚Šã¾ã™ã€‚

â†“ã“ã‚“ãªæ„Ÿã˜

![](https://storage.googleapis.com/zenn-user-upload/ad7d48a80768-20240707.png)

- ã©ã¡ã‚‰ã‹ã®å¤‰æ›´ã§ã‚ã‚Œã°ã€1ã¤ã®ã‚¸ãƒ§ãƒ–ã ã‘ãŒèµ°ã‚Šã¾ã™ã€‚
- ã„ãšã‚Œã‚‚å¤‰æ›´ãŒãªã„å ´åˆï¼ˆex: READMEå¤‰æ›´æ™‚ãªã©ï¼‰ã¯ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†’é ­ã®`on.paths`ã§`src/**`ä»¥ä¸‹ã®ã¿ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã®ã§ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è‡ªä½“ãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã¾ã›ã‚“ã€‚


### Secretã®å‹•çš„å‚ç…§

Github Secretã¯ç’°å¢ƒã”ã¨ã«å‚ç…§ã™ã‚‹ã‚­ãƒ¼ãŒç•°ãªã‚Šã¾ã™ã€‚ãã®ãŸã‚ã“ã“ã¯ã¡ã‚‡ã£ã¨å·¥å¤«ã—ã¾ã—ãŸã€‚

ã“ã“ã§ã‚‚å¤‰æ›´æ¤œçŸ¥ã‚¸ãƒ§ãƒ–ã®outputã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
æœ¬æ¥ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå‚ç…§ã«ã¯`${{ secrets.ã‚­ãƒ¼å }}`ã¨ã„ã†æŒ‡å®šã‚’ã—ã¾ã™ãŒã€ä»Šå›ã¯matrixé…åˆ—ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡å®šã—ã¦ã€ä»¥ä¸‹ã®æ›¸ãæ–¹ã‚’ã™ã‚‹ã“ã¨ã§ç’°å¢ƒã”ã¨ã§å‹•çš„å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```yaml
${{ secrets[matrix.credentials_key] }}

# å±•é–‹ã™ã‚‹ã¨
# stgã®å ´åˆ
${{ secrets.GCP_CREDENTIALS_STG }}
# prodã®å ´åˆ
${{ secrets.GCP_CREDENTIALS_PROD }}
```

ãªãŠã€GCPã¨ã®èªè¨¼ã‚„ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«ã¤ã„ã¦è©³ã—ãã¯çœç•¥ã—ã¾ã™ãŒã€[ã“ã¡ã‚‰ã®è¨˜äº‹](https://times.hrbrain.co.jp/entry/terraform-plan-github-actions)ã‚’å‚è€ƒã«ã•ã›ã¦ã„ãŸã ãã¾ã—ãŸã€‚


### tfcmt

```yaml
      - name: tfcmt plan
        run: tfcmt -var "target:$(echo ${{ matrix.dir }} | sed 's/src\///g')" plan -patch -- terraform plan -no-color -lock=false
        env:
          PR_HEAD_SHA: ${{ github.event.pull_request.head.sha }}
          PR_NUMBER: ${{ github.event.number }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

è©³ã—ã„ä½¿ã„æ–¹ã¯ã€[tfcmtã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://suzuki-shunsuke.github.io/tfcmt/getting-started/#support-of-ci-platforms)ã‚’ã”è¦§ãã ã•ã„ã€‚

- ä»Šå›ã¯`-patch`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ«ãƒªã‚¯ãŒæ›´æ–°ã•ã‚Œã¦planãŒå†å®Ÿè¡Œã•ã‚ŒãŸæ™‚ã«ã€tfcmtãŒæ—¢å­˜ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯æ—¢å­˜ã‚³ãƒ¡ãƒ³ãƒˆãŒHideã•ã‚Œã¦æ–°ã—ã„ã‚³ãƒ¡ãƒ³ãƒˆãŒä½œã‚‰ã‚Œã¾ã™ï¼‰
    - [å‚è€ƒ](https://suzuki-shunsuke.github.io/tfcmt/plan-patch)

â†“çµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ—ãƒ«ãƒªã‚¯ã«è‡ªå‹•ã‚³ãƒ¡ãƒ³ãƒˆã•ã‚Œã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/342b2946f8a4-20240707.png)

- `Change Result (Click me)`ã‚’å±•é–‹ã™ã‚‹ã¨è©³ç´°ãªå·®åˆ†ãŒè¦‹ã‚Œã¾ã™ã€‚
- `destroy`ã‚„`add-or-update`ã®ã‚ˆã†ãªãƒ©ãƒ™ãƒ«ã‚‚è‡ªå‹•ä»˜ä¸ã—ã¦ãã‚Œã‚‹ã®ã‚‚åœ°å‘³ã«è‰¯ã„ã§ã™ã€‚

# ã¾ã¨ã‚

ä»Šå›çµ„ã‚“ã CIã§ã¯ä¸»ã«ä»¥ä¸‹ãŒã†ã¾ãã§ãã¾ã—ãŸã€‚

- å¤‰æ›´æ¤œçŸ¥ã¨é©åˆ‡ãªplanå¯¾è±¡ã®çµã‚Šè¾¼ã¿ï¼šstgã¾ãŸã¯prodãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å¤‰æ›´æ™‚ã¯ãã‚Œãã‚Œã®ç’°å¢ƒã®ã¿ã€commonï¼ˆå…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ã®å¤‰æ›´æ™‚ã¯å…¨ç’°å¢ƒã«planå®Ÿè¡Œã€‚
- ç’°å¢ƒåˆ¥ã§Secretã®å‹•çš„å‚ç…§

ãã—ã¦ã€é‹ç”¨é¢ã§ã¯ä»¥ä¸‹ã®ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚

- CIå®Ÿè¡Œæ™‚é–“ã®ç¯€ç´„ã€‚
- tfcmtãŒã™ã”ãè‰¯ã„æ„Ÿã˜ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’ãƒ—ãƒ«ãƒªã‚¯ã«ã‚³ãƒ¡ãƒ³ãƒˆã—ã¦ãã‚Œã‚‹ã®ã§ã€ãƒ—ãƒ«ãƒªã‚¯ä½œæˆè€…ã¨ãƒ¬ãƒ“ãƒ¥ãƒ¯ãƒ¼ã®è² æ‹…æ¸›ã€‚

ã¾ãŸã€Githubã§ã®CI/CDã‚’æ¤œè¨ã™ã‚‹ã«ã‚ãŸã£ã¦ã€ã“ã¡ã‚‰ã®æ›¸ç±ã€GitHub CI/CDå®Ÿè·µã‚¬ã‚¤ãƒ‰ã€ãŒã¨ã¦ã‚‚å‚è€ƒã«ãªã£ãŸã®ã§æ¿€æ¨ã—ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚

https://gihyo.jp/book/2024/978-4-297-14173-8


# ä»Šå¾Œã®TODO

- GCPã¨ã®æ¨©é™é€£æºã«ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã§ã€ã‚ˆã‚Šã‚»ã‚­ãƒ¥ã‚¢ãªWorkload Identityé€£æºã«ç§»è¡Œã™ã‚‹ã€‚
- Actionsã§`set-output`ãŒéæ¨å¥¨ãªã®ã§ã€Environment Filesã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã«ã™ã‚‹ã€‚

# å‚è€ƒ

https://times.hrbrain.co.jp/entry/terraform-plan-github-actions

https://suzuki-shunsuke.github.io/tfcmt/